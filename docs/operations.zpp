/*******************************************************************************
 * Z++ FORMAL SPECIFICATION: OPERATIONS
 * 
 * RsyncOG Cognitive Architecture - Operation Specifications
 * 
 * This specification formalizes all operations that modify the system state,
 * including initialization, agent operations, sync operations, learning,
 * and reconfiguration.
 *
 * Copyright (C) 2025 OpenCog Cognitive Architecture Project
 * Licensed under GNU GPL v3.0
 ******************************************************************************/

/*=============================================================================
 * SECTION 1: SYSTEM INITIALIZATION OPERATIONS
 *===========================================================================*/

/**
 * InitializeSystem Operation
 *
 * Initializes the complete RsyncOG system from scratch.
 *
 * Pre-conditions:
 * - System is not already initialized
 *
 * Post-conditions:
 * - Empty AtomSpace created
 * - All essential agents created and registered
 * - Agent Zero is designated as orchestrator
 * - System marked as initialized but not running
 * - Startup time recorded
 */
â”Œâ”€ InitializeSystem â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”SystemState                                                           â”‚
â”‚ startup_timestamp? : TIMESTAMP                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ Â¬ initialized                                                          â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ initialized' = true                                                    â”‚
â”‚ running' = false                                                       â”‚
â”‚ startup_time' = startup_timestamp?                                     â”‚
â”‚                                                                         â”‚
â”‚ /* Create empty AtomSpace */                                           â”‚
â”‚ atomspace' = EmptyAtomSpace                                            â”‚
â”‚                                                                         â”‚
â”‚ /* Create essential agents */                                          â”‚
â”‚ #agents' = 6                                                           â”‚
â”‚ âˆƒ a0, am, aa, as, asw, ah : CogAgent |                                 â”‚
â”‚   {a0, am, aa, as, asw, ah} âŠ† ran agents' âˆ§                            â”‚
â”‚   a0.agent_type = cog_agent_zero âˆ§                                     â”‚
â”‚   am.agent_type = cog_agent_monitor âˆ§                                  â”‚
â”‚   aa.agent_type = cog_agent_auth âˆ§                                     â”‚
â”‚   as.agent_type = cog_agent_sync âˆ§                                     â”‚
â”‚   asw.agent_type = cog_agent_swarm âˆ§                                   â”‚
â”‚   ah.agent_type = cog_agent_hypergraph âˆ§                               â”‚
â”‚   agent_zero' = a0 âˆ§                                                   â”‚
â”‚   swarm_coordinator' = asw                                             â”‚
â”‚                                                                         â”‚
â”‚ /* Initialize contexts */                                              â”‚
â”‚ pln_context' = DefaultPLNInferenceContext                              â”‚
â”‚ pln_context'.atomspace = atomspace'                                    â”‚
â”‚                                                                         â”‚
â”‚ learning_context'.history = âŸ¨âŸ©                                         â”‚
â”‚ learning_context'.history_count = 0                                    â”‚
â”‚ learning_context'.atomspace = atomspace'                               â”‚
â”‚                                                                         â”‚
â”‚ /* No swarms initially */                                              â”‚
â”‚ swarm_formations' = âŸ¨âŸ©                                                 â”‚
â”‚                                                                         â”‚
â”‚ /* No reconfigurations yet */                                          â”‚
â”‚ last_config_gen' = 0                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/**
 * StartSystem Operation
 *
 * Starts the initialized system for normal operation.
 *
 * Pre-conditions:
 * - System is initialized but not running
 *
 * Post-conditions:
 * - System marked as running
 * - All agents transitioned to IDLE or ACTIVE state
 */
â”Œâ”€ StartSystem â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”SystemState                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ initialized âˆ§ Â¬ running                                                â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ running' = true                                                        â”‚
â”‚                                                                         â”‚
â”‚ /* All agents become operational */                                    â”‚
â”‚ âˆ€ a : CogAgent | a âˆˆ ran agents â‡’                                      â”‚
â”‚   (âˆƒ a' : CogAgent | a' âˆˆ ran agents' âˆ§                                â”‚
â”‚      a'.agent_id = a.agent_id âˆ§                                        â”‚
â”‚      a'.state âˆˆ {cog_state_idle, cog_state_active})                    â”‚
â”‚                                                                         â”‚
â”‚ /* Monitor agent is active */                                          â”‚
â”‚ âˆƒ a' : CogAgent | a' âˆˆ ran agents' âˆ§                                   â”‚
â”‚   a'.agent_type = cog_agent_monitor âˆ§                                  â”‚
â”‚   a'.state = cog_state_active                                          â”‚
â”‚                                                                         â”‚
â”‚ /* AtomSpace unchanged */                                              â”‚
â”‚ atomspace' = atomspace                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/**
 * ShutdownSystem Operation
 *
 * Gracefully shuts down the system.
 *
 * Pre-conditions:
 * - System is running
 *
 * Post-conditions:
 * - All agents shutdown
 * - All swarms disbanded
 * - AtomSpace persisted
 * - System marked as not running
 */
â”Œâ”€ ShutdownSystem â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”SystemState                                                           â”‚
â”‚ persist_path? : NAME                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ running                                                                â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ running' = false                                                       â”‚
â”‚                                                                         â”‚
â”‚ /* All agents shutdown */                                              â”‚
â”‚ âˆ€ a' : CogAgent | a' âˆˆ ran agents' â‡’                                   â”‚
â”‚   a'.state = cog_state_shutdown                                        â”‚
â”‚                                                                         â”‚
â”‚ /* All swarms disbanded */                                             â”‚
â”‚ swarm_formations' = âŸ¨âŸ©                                                 â”‚
â”‚                                                                         â”‚
â”‚ /* AtomSpace persisted */                                              â”‚
â”‚ atomspace_serialized(atomspace, persist_path?)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/*=============================================================================
 * SECTION 2: ATOMSPACE OPERATIONS
 *===========================================================================*/

/**
 * AddModuleAtom Operation
 *
 * Adds a new rsync module to the AtomSpace.
 *
 * Pre-conditions:
 * - Module with given name doesn't already exist
 * - Module path is valid
 *
 * Post-conditions:
 * - New module atom created with default TV/AV
 * - Atom count incremented
 * - Handle assigned
 */
â”Œâ”€ AddModuleAtom â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”AtomSpace                                                             â”‚
â”‚ module_name? : NAME                                                    â”‚
â”‚ module_path? : NAME                                                    â”‚
â”‚ read_only? : ğ”¹                                                         â”‚
â”‚ new_handle! : HANDLE                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ module_name? â‰  âˆ… âˆ§ module_path? â‰  âˆ…                                    â”‚
â”‚ Â¬ âˆƒ a : Atom | a âˆˆ ran atom_table âˆ§                                    â”‚
â”‚                a.atom_type = atom_module âˆ§                             â”‚
â”‚                a.name = module_name?                                   â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ âˆƒ new_atom : ModuleAtom |                                              â”‚
â”‚   new_atom.handle = next_handle âˆ§                                      â”‚
â”‚   new_atom.name = module_name? âˆ§                                       â”‚
â”‚   new_atom.module_path = module_path? âˆ§                                â”‚
â”‚   new_atom.read_only = read_only? âˆ§                                    â”‚
â”‚   new_atom.tv = DefaultTruthValue âˆ§                                    â”‚
â”‚   new_atom.av = DefaultAttentionValue âˆ§                                â”‚
â”‚   new_atom.access_count = 0 âˆ§                                          â”‚
â”‚   atom_table' = atom_table âˆª {new_atom.handle â†¦ new_atom}              â”‚
â”‚                                                                         â”‚
â”‚ new_handle! = next_handle                                              â”‚
â”‚ next_handle' = next_handle + 1                                         â”‚
â”‚ atom_count' = atom_count + 1                                           â”‚
â”‚                                                                         â”‚
â”‚ /* Links unchanged */                                                  â”‚
â”‚ link_table' = link_table                                               â”‚
â”‚ link_count' = link_count                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/**
 * AddSyncTopologyLink Operation
 *
 * Creates a sync topology link between module and host atoms.
 *
 * Pre-conditions:
 * - Both module and host atoms exist
 * - Link doesn't already exist
 *
 * Post-conditions:
 * - New link created
 * - Link count incremented
 */
â”Œâ”€ AddSyncTopologyLink â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”AtomSpace                                                             â”‚
â”‚ module_handle? : HANDLE                                                â”‚
â”‚ host_handle? : HANDLE                                                  â”‚
â”‚ new_link_handle! : HANDLE                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ module_handle? âˆˆ dom atom_table                                        â”‚
â”‚ host_handle? âˆˆ dom atom_table                                          â”‚
â”‚ atom_table(module_handle?).atom_type = atom_module                     â”‚
â”‚ atom_table(host_handle?).atom_type = atom_host                         â”‚
â”‚                                                                         â”‚
â”‚ /* Link doesn't exist */                                               â”‚
â”‚ Â¬ âˆƒ l : AtomLink | l âˆˆ ran link_table âˆ§                                â”‚
â”‚                    l.link_type = link_sync_topology âˆ§                  â”‚
â”‚                    l.outgoing(1).handle = module_handle? âˆ§             â”‚
â”‚                    l.outgoing(2).handle = host_handle?                 â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ âˆƒ new_link : SyncTopologyLink |                                        â”‚
â”‚   new_link.handle = next_handle âˆ§                                      â”‚
â”‚   new_link.outgoing = âŸ¨atom_table(module_handle?),                     â”‚
â”‚                         atom_table(host_handle?)âŸ© âˆ§                    â”‚
â”‚   new_link.tv = DefaultTruthValue âˆ§                                    â”‚
â”‚   new_link.av = DefaultAttentionValue âˆ§                                â”‚
â”‚   link_table' = link_table âˆª {new_link.handle â†¦ new_link}              â”‚
â”‚                                                                         â”‚
â”‚ new_link_handle! = next_handle                                         â”‚
â”‚ next_handle' = next_handle + 1                                         â”‚
â”‚ link_count' = link_count + 1                                           â”‚
â”‚                                                                         â”‚
â”‚ /* Atoms unchanged */                                                  â”‚
â”‚ atom_table' = atom_table                                               â”‚
â”‚ atom_count' = atom_count                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/**
 * UpdateTruthValue Operation
 *
 * Updates the truth value of an atom based on new evidence.
 *
 * Pre-conditions:
 * - Atom exists
 * - New strength and confidence are valid
 *
 * Post-conditions:
 * - Atom's truth value updated
 * - Access count incremented
 * - Last accessed time updated
 */
â”Œâ”€ UpdateTruthValue â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”AtomSpace                                                             â”‚
â”‚ atom_handle? : HANDLE                                                  â”‚
â”‚ new_strength? : â„                                                      â”‚
â”‚ new_confidence? : â„                                                    â”‚
â”‚ current_time? : TIMESTAMP                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ atom_handle? âˆˆ dom atom_table                                          â”‚
â”‚ 0.0 â‰¤ new_strength? â‰¤ 1.0                                              â”‚
â”‚ 0.0 â‰¤ new_confidence? â‰¤ 1.0                                            â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ âˆƒ old_atom, new_atom : Atom |                                          â”‚
â”‚   old_atom = atom_table(atom_handle?) âˆ§                                â”‚
â”‚   new_atom.handle = old_atom.handle âˆ§                                  â”‚
â”‚   new_atom.atom_type = old_atom.atom_type âˆ§                            â”‚
â”‚   new_atom.name = old_atom.name âˆ§                                      â”‚
â”‚   new_atom.tv.strength = new_strength? âˆ§                               â”‚
â”‚   new_atom.tv.confidence = new_confidence? âˆ§                           â”‚
â”‚   new_atom.av = old_atom.av âˆ§                                          â”‚
â”‚   new_atom.access_count = old_atom.access_count + 1 âˆ§                  â”‚
â”‚   new_atom.last_accessed = current_time? âˆ§                             â”‚
â”‚   atom_table' = atom_table âŠ• {atom_handle? â†¦ new_atom}                 â”‚
â”‚                                                                         â”‚
â”‚ /* Counts unchanged */                                                 â”‚
â”‚ atom_count' = atom_count                                               â”‚
â”‚ link_table' = link_table                                               â”‚
â”‚ link_count' = link_count                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/**
 * UpdateAttentionValue Operation
 *
 * Updates attention (STI/LTI) for an atom based on activity.
 *
 * Pre-conditions:
 * - Atom exists
 * - New attention values are within bounds
 *
 * Post-conditions:
 * - Atom's attention values updated
 * - Attention queue may be reordered
 */
â”Œâ”€ UpdateAttentionValue â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”AtomSpace                                                             â”‚
â”‚ atom_handle? : HANDLE                                                  â”‚
â”‚ new_sti? : â„¤                                                           â”‚
â”‚ new_lti? : â„¤                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ atom_handle? âˆˆ dom atom_table                                          â”‚
â”‚ -32768 â‰¤ new_sti? â‰¤ 32767                                              â”‚
â”‚ -32768 â‰¤ new_lti? â‰¤ 32767                                              â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ âˆƒ old_atom, new_atom : Atom |                                          â”‚
â”‚   old_atom = atom_table(atom_handle?) âˆ§                                â”‚
â”‚   new_atom.handle = old_atom.handle âˆ§                                  â”‚
â”‚   new_atom.atom_type = old_atom.atom_type âˆ§                            â”‚
â”‚   new_atom.name = old_atom.name âˆ§                                      â”‚
â”‚   new_atom.tv = old_atom.tv âˆ§                                          â”‚
â”‚   new_atom.av.sti = new_sti? âˆ§                                         â”‚
â”‚   new_atom.av.lti = new_lti? âˆ§                                         â”‚
â”‚   new_atom.av.vlti = old_atom.av.vlti âˆ§                                â”‚
â”‚   atom_table' = atom_table âŠ• {atom_handle? â†¦ new_atom}                 â”‚
â”‚                                                                         â”‚
â”‚ /* Attention queue updated (sorted by STI descending) */               â”‚
â”‚ attention_queue' = sort_by_sti(ran atom_table')                        â”‚
â”‚                                                                         â”‚
â”‚ /* Counts unchanged */                                                 â”‚
â”‚ atom_count' = atom_count                                               â”‚
â”‚ link_count' = link_count                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/*=============================================================================
 * SECTION 3: SWARM FORMATION OPERATIONS
 *===========================================================================*/

/**
 * CreateSwarmFormation Operation
 *
 * Creates a new swarm formation for coordinated sync.
 *
 * Pre-conditions:
 * - Swarm name is unique
 * - At least 2 members provided
 * - All member atoms exist
 *
 * Post-conditions:
 * - New swarm atom created in AtomSpace
 * - SwarmFormation created with members
 * - Swarm links created for each member
 * - Swarm in FORMING state
 */
â”Œâ”€ CreateSwarmFormation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”SystemState                                                           â”‚
â”‚ swarm_name? : NAME                                                     â”‚
â”‚ member_handles? : seq HANDLE                                           â”‚
â”‚ swarm_id! : HANDLE                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ swarm_name? â‰  âˆ…                                                        â”‚
â”‚ #member_handles? â‰¥ 2                                                   â”‚
â”‚                                                                         â”‚
â”‚ /* Swarm doesn't exist */                                              â”‚
â”‚ Â¬ âˆƒ sf : SwarmFormation | sf âˆˆ ran swarm_formations âˆ§                  â”‚
â”‚                           sf.name = swarm_name?                        â”‚
â”‚                                                                         â”‚
â”‚ /* All members exist in AtomSpace */                                   â”‚
â”‚ âˆ€ h : HANDLE | h âˆˆ ran member_handles? â‡’                               â”‚
â”‚   h âˆˆ dom atomspace.atom_table                                         â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ âˆƒ swarm_atom : SwarmAtom |                                             â”‚
â”‚   swarm_atom.swarm_name = swarm_name? âˆ§                                â”‚
â”‚   swarm_atom.member_count = #member_handles? âˆ§                         â”‚
â”‚   swarm_atom.handle = atomspace.next_handle âˆ§                          â”‚
â”‚   swarm_atom âˆˆ ran atomspace'.atom_table                               â”‚
â”‚                                                                         â”‚
â”‚ âˆƒ new_swarm : SwarmFormation |                                         â”‚
â”‚   new_swarm.swarm_id = atomspace.next_handle âˆ§                         â”‚
â”‚   new_swarm.name = swarm_name? âˆ§                                       â”‚
â”‚   new_swarm.state = swarm_forming âˆ§                                    â”‚
â”‚   new_swarm.member_count = #member_handles? âˆ§                          â”‚
â”‚   new_swarm.coordinator = swarm_coordinator âˆ§                          â”‚
â”‚   new_swarm.swarm_atom = swarm_atom âˆ§                                  â”‚
â”‚   new_swarm.total_syncs = 0 âˆ§                                          â”‚
â”‚   new_swarm.total_bytes = 0 âˆ§                                          â”‚
â”‚   swarm_formations' = swarm_formations âŒ¢ âŸ¨new_swarmâŸ©                   â”‚
â”‚                                                                         â”‚
â”‚ /* Create swarm member links */                                        â”‚
â”‚ âˆ€ h : HANDLE | h âˆˆ ran member_handles? â‡’                               â”‚
â”‚   âˆƒ link : SwarmMemberLink |                                           â”‚
â”‚     link.outgoing(1) = swarm_atom âˆ§                                    â”‚
â”‚     link.outgoing(2) = atomspace.atom_table(h) âˆ§                       â”‚
â”‚     link âˆˆ ran atomspace'.link_table                                   â”‚
â”‚                                                                         â”‚
â”‚ swarm_id! = atomspace.next_handle                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/**
 * ActivateSwarm Operation
 *
 * Transitions swarm from FORMING to ACTIVE state.
 *
 * Pre-conditions:
 * - Swarm exists and is in FORMING state
 * - All members have valid configurations
 *
 * Post-conditions:
 * - Swarm state changed to ACTIVE
 * - All members in ACTIVE state
 * - Swarm ready for coordination
 */
â”Œâ”€ ActivateSwarm â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”SystemState                                                           â”‚
â”‚ swarm_id? : HANDLE                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ âˆƒ swarm : SwarmFormation | swarm âˆˆ ran swarm_formations âˆ§              â”‚
â”‚   swarm.swarm_id = swarm_id? âˆ§                                         â”‚
â”‚   swarm.state = swarm_forming âˆ§                                        â”‚
â”‚   swarm.member_count â‰¥ 2                                               â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ âˆƒ old_swarm, new_swarm : SwarmFormation |                              â”‚
â”‚   old_swarm âˆˆ ran swarm_formations âˆ§                                   â”‚
â”‚   old_swarm.swarm_id = swarm_id? âˆ§                                     â”‚
â”‚   new_swarm.swarm_id = old_swarm.swarm_id âˆ§                            â”‚
â”‚   new_swarm.name = old_swarm.name âˆ§                                    â”‚
â”‚   new_swarm.state = swarm_active âˆ§                                     â”‚
â”‚   new_swarm.members = old_swarm.members âˆ§                              â”‚
â”‚   new_swarm.member_count = old_swarm.member_count âˆ§                    â”‚
â”‚   new_swarm âˆˆ ran swarm_formations'                                    â”‚
â”‚                                                                         â”‚
â”‚ /* All members become active */                                        â”‚
â”‚ âˆ€ m : SwarmMember | m âˆˆ ran new_swarm.members â‡’                        â”‚
â”‚   m.state = swarm_active                                               â”‚
â”‚                                                                         â”‚
â”‚ /* Swarm coordinator is active */                                      â”‚
â”‚ swarm_coordinator'.state = cog_state_active                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/*=============================================================================
 * SECTION 4: SYNC OPERATIONS
 *===========================================================================*/

/**
 * InitiateSync Operation
 *
 * Initiates a synchronization operation for a module.
 *
 * Pre-conditions:
 * - Module atom exists
 * - Host atom exists or is implicit
 * - System is running
 *
 * Post-conditions:
 * - Sync operation recorded
 * - Module's access count incremented
 * - PLN prediction requested
 */
â”Œâ”€ InitiateSync â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”SystemState                                                           â”‚
â”‚ module_handle? : HANDLE                                                â”‚
â”‚ host_handle? : HANDLE                                                  â”‚
â”‚ predicted_success! : TruthValue                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ running                                                                â”‚
â”‚ module_handle? âˆˆ dom atomspace.atom_table                              â”‚
â”‚ host_handle? âˆˆ dom atomspace.atom_table                                â”‚
â”‚ atomspace.atom_table(module_handle?).atom_type = atom_module           â”‚
â”‚ atomspace.atom_table(host_handle?).atom_type = atom_host               â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ /* PLN predicts sync success */                                        â”‚
â”‚ predicted_success! = pln_predict_sync_success(                         â”‚
â”‚   pln_context,                                                         â”‚
â”‚   atomspace.atom_table(module_handle?),                                â”‚
â”‚   atomspace.atom_table(host_handle?))                                  â”‚
â”‚                                                                         â”‚
â”‚ /* Module atom accessed */                                             â”‚
â”‚ âˆƒ old_module, new_module : Atom |                                      â”‚
â”‚   old_module = atomspace.atom_table(module_handle?) âˆ§                  â”‚
â”‚   new_module.access_count = old_module.access_count + 1 âˆ§              â”‚
â”‚   new_module âˆˆ ran atomspace'.atom_table                               â”‚
â”‚                                                                         â”‚
â”‚ /* Prediction count incremented */                                     â”‚
â”‚ pln_context'.predictions_made =                                        â”‚
â”‚   pln_context.predictions_made + 1                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/**
 * RecordSyncSuccess Operation
 *
 * Records a successful sync operation and updates learning.
 *
 * Pre-conditions:
 * - Sync was initiated
 * - Module and host exist
 *
 * Post-conditions:
 * - Sync history entry created
 * - Module truth value updated (increased strength/confidence)
 * - Module attention increased (STI++)
 * - Production monitor updated
 */
â”Œâ”€ RecordSyncSuccess â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”SystemState                                                           â”‚
â”‚ module_handle? : HANDLE                                                â”‚
â”‚ host_handle? : HANDLE                                                  â”‚
â”‚ bytes_transferred? : â„•                                                 â”‚
â”‚ duration? : â„•                                                          â”‚
â”‚ current_time? : TIMESTAMP                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ module_handle? âˆˆ dom atomspace.atom_table                              â”‚
â”‚ host_handle? âˆˆ dom atomspace.atom_table                                â”‚
â”‚ bytes_transferred? â‰¥ 0                                                 â”‚
â”‚ duration? > 0                                                          â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ /* Create history entry */                                             â”‚
â”‚ âˆƒ new_entry : SyncHistoryEntry |                                       â”‚
â”‚   new_entry.entry_id = learning_context.history_count + 1 âˆ§            â”‚
â”‚   new_entry.module_name =                                              â”‚
â”‚     atomspace.atom_table(module_handle?).name âˆ§                        â”‚
â”‚   new_entry.host_name =                                                â”‚
â”‚     atomspace.atom_table(host_handle?).name âˆ§                          â”‚
â”‚   new_entry.success = true âˆ§                                           â”‚
â”‚   new_entry.bytes_transferred = bytes_transferred? âˆ§                   â”‚
â”‚   new_entry.duration = duration? âˆ§                                     â”‚
â”‚   new_entry.timestamp = current_time? âˆ§                                â”‚
â”‚   new_entry âˆˆ ran learning_context'.history                            â”‚
â”‚                                                                         â”‚
â”‚ /* Update module truth value (strengthen) */                           â”‚
â”‚ âˆƒ old_module, new_module : Atom |                                      â”‚
â”‚   old_module = atomspace.atom_table(module_handle?) âˆ§                  â”‚
â”‚   new_module.tv.strength =                                             â”‚
â”‚     min(1.0, old_module.tv.strength + 0.05) âˆ§                          â”‚
â”‚   new_module.tv.confidence =                                           â”‚
â”‚     min(1.0, old_module.tv.confidence + 0.01) âˆ§                        â”‚
â”‚   new_module âˆˆ ran atomspace'.atom_table                               â”‚
â”‚                                                                         â”‚
â”‚ /* Increase attention */                                               â”‚
â”‚ new_module.av.sti = min(32767, old_module.av.sti + 10)                 â”‚
â”‚                                                                         â”‚
â”‚ /* Update production monitor */                                        â”‚
â”‚ production_monitor'.successful_sync_ops =                              â”‚
â”‚   production_monitor.successful_sync_ops + 1                           â”‚
â”‚ production_monitor'.total_sync_ops =                                   â”‚
â”‚   production_monitor.total_sync_ops + 1                                â”‚
â”‚ production_monitor'.total_bytes_synced =                               â”‚
â”‚   production_monitor.total_bytes_synced + bytes_transferred?           â”‚
â”‚                                                                         â”‚
â”‚ /* Update learning stats */                                            â”‚
â”‚ learning_context'.stats.predictions_correct =                          â”‚
â”‚   learning_context.stats.predictions_correct + 1                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/**
 * RecordSyncFailure Operation
 *
 * Records a failed sync operation and updates learning.
 *
 * Pre-conditions:
 * - Sync was initiated
 * - Module and host exist
 *
 * Post-conditions:
 * - Sync history entry created with failure
 * - Module truth value updated (decreased strength)
 * - Module attention may decrease
 * - Production monitor updated
 */
â”Œâ”€ RecordSyncFailure â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”SystemState                                                           â”‚
â”‚ module_handle? : HANDLE                                                â”‚
â”‚ host_handle? : HANDLE                                                  â”‚
â”‚ error_code? : â„¤                                                        â”‚
â”‚ current_time? : TIMESTAMP                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ module_handle? âˆˆ dom atomspace.atom_table                              â”‚
â”‚ host_handle? âˆˆ dom atomspace.atom_table                                â”‚
â”‚ error_code? â‰  0                                                        â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ /* Create history entry */                                             â”‚
â”‚ âˆƒ new_entry : SyncHistoryEntry |                                       â”‚
â”‚   new_entry.entry_id = learning_context.history_count + 1 âˆ§            â”‚
â”‚   new_entry.module_name =                                              â”‚
â”‚     atomspace.atom_table(module_handle?).name âˆ§                        â”‚
â”‚   new_entry.host_name =                                                â”‚
â”‚     atomspace.atom_table(host_handle?).name âˆ§                          â”‚
â”‚   new_entry.success = false âˆ§                                          â”‚
â”‚   new_entry.error_code = error_code? âˆ§                                 â”‚
â”‚   new_entry.timestamp = current_time? âˆ§                                â”‚
â”‚   new_entry âˆˆ ran learning_context'.history                            â”‚
â”‚                                                                         â”‚
â”‚ /* Update module truth value (weaken) */                               â”‚
â”‚ âˆƒ old_module, new_module : Atom |                                      â”‚
â”‚   old_module = atomspace.atom_table(module_handle?) âˆ§                  â”‚
â”‚   new_module.tv.strength =                                             â”‚
â”‚     max(0.0, old_module.tv.strength - 0.1) âˆ§                           â”‚
â”‚   new_module.tv.confidence = old_module.tv.confidence âˆ§                â”‚
â”‚   new_module âˆˆ ran atomspace'.atom_table                               â”‚
â”‚                                                                         â”‚
â”‚ /* Decrease attention for repeated failures */                         â”‚
â”‚ old_module.tv.strength < 0.5 â‡’                                         â”‚
â”‚   new_module.av.sti = max(-32768, old_module.av.sti - 20)              â”‚
â”‚                                                                         â”‚
â”‚ /* Update production monitor */                                        â”‚
â”‚ production_monitor'.failed_sync_ops =                                  â”‚
â”‚   production_monitor.failed_sync_ops + 1                               â”‚
â”‚ production_monitor'.total_sync_ops =                                   â”‚
â”‚   production_monitor.total_sync_ops + 1                                â”‚
â”‚                                                                         â”‚
â”‚ /* Update learning stats */                                            â”‚
â”‚ learning_context'.stats.predictions_incorrect =                        â”‚
â”‚   learning_context.stats.predictions_incorrect + 1                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/*=============================================================================
 * SECTION 5: PLN INFERENCE OPERATIONS
 *===========================================================================*/

/**
 * ApplyPLNDeduction Operation
 *
 * Applies PLN deduction rule: if Aâ†’B and Bâ†’C, infer Aâ†’C.
 *
 * Pre-conditions:
 * - Two links exist representing Aâ†’B and Bâ†’C
 * - Confidence exceeds threshold
 *
 * Post-conditions:
 * - New inferred link Aâ†’C created if not exists
 * - Inferred truth value calculated using PLN formulas
 * - Inference count incremented
 */
â”Œâ”€ ApplyPLNDeduction â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”SystemState                                                           â”‚
â”‚ link_ab? : HANDLE                                                      â”‚
â”‚ link_bc? : HANDLE                                                      â”‚
â”‚ new_link_handle! : HANDLE                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ link_ab? âˆˆ dom atomspace.link_table                                    â”‚
â”‚ link_bc? âˆˆ dom atomspace.link_table                                    â”‚
â”‚                                                                         â”‚
â”‚ âˆƒ l_ab, l_bc : AtomLink |                                              â”‚
â”‚   l_ab = atomspace.link_table(link_ab?) âˆ§                              â”‚
â”‚   l_bc = atomspace.link_table(link_bc?) âˆ§                              â”‚
â”‚   /* B is common middle term */                                        â”‚
â”‚   l_ab.outgoing(2) = l_bc.outgoing(1) âˆ§                                â”‚
â”‚   /* Sufficient confidence */                                          â”‚
â”‚   l_ab.tv.confidence â‰¥ pln_context.confidence_threshold âˆ§              â”‚
â”‚   l_bc.tv.confidence â‰¥ pln_context.confidence_threshold                â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ âˆƒ l_ab, l_bc, l_ac : AtomLink |                                        â”‚
â”‚   l_ab = atomspace.link_table(link_ab?) âˆ§                              â”‚
â”‚   l_bc = atomspace.link_table(link_bc?) âˆ§                              â”‚
â”‚   /* Create Aâ†’C link */                                                â”‚
â”‚   l_ac.outgoing = âŸ¨l_ab.outgoing(1), l_bc.outgoing(2)âŸ© âˆ§               â”‚
â”‚   /* Calculate inferred truth value using PLN formula */               â”‚
â”‚   l_ac.tv.strength =                                                   â”‚
â”‚     l_ab.tv.strength Ã— l_bc.tv.strength âˆ§                              â”‚
â”‚   l_ac.tv.confidence =                                                 â”‚
â”‚     min(l_ab.tv.confidence, l_bc.tv.confidence) Ã— 0.9 âˆ§                â”‚
â”‚   l_ac âˆˆ ran atomspace'.link_table                                     â”‚
â”‚                                                                         â”‚
â”‚ new_link_handle! = l_ac.handle                                         â”‚
â”‚                                                                         â”‚
â”‚ /* Update PLN statistics */                                            â”‚
â”‚ pln_context'.inferences_performed =                                    â”‚
â”‚   pln_context.inferences_performed + 1                                 â”‚
â”‚ pln_context'.rules_applied =                                           â”‚
â”‚   pln_context.rules_applied + 1                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/**
 * DiscoverSyncPattern Operation
 *
 * Discovers a sync pattern from historical data using PLN induction.
 *
 * Pre-conditions:
 * - Sufficient history entries exist for module
 * - Learning context is active
 *
 * Post-conditions:
 * - New SyncPattern created
 * - Pattern added to PLN context
 * - Statistics updated
 */
â”Œâ”€ DiscoverSyncPattern â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”SystemState                                                           â”‚
â”‚ module_name? : NAME                                                    â”‚
â”‚ min_observations? : â„•                                                  â”‚
â”‚ pattern_found! : ğ”¹                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ min_observations? â‰¥ 10                                                 â”‚
â”‚                                                                         â”‚
â”‚ /* Sufficient history for this module */                               â”‚
â”‚ #({h : SyncHistoryEntry | h âˆˆ ran learning_context.history âˆ§           â”‚
â”‚    h.module_name = module_name?}) â‰¥ min_observations?                  â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ âˆƒ relevant_history : seq SyncHistoryEntry |                            â”‚
â”‚   relevant_history = {h : SyncHistoryEntry |                           â”‚
â”‚     h âˆˆ ran learning_context.history âˆ§                                 â”‚
â”‚     h.module_name = module_name?} âˆ§                                    â”‚
â”‚                                                                         â”‚
â”‚   âˆƒ new_pattern : SyncPattern |                                        â”‚
â”‚     new_pattern.module_name = module_name? âˆ§                           â”‚
â”‚     new_pattern.total_syncs = #relevant_history âˆ§                      â”‚
â”‚     new_pattern.successful_syncs =                                     â”‚
â”‚       #{h : SyncHistoryEntry | h âˆˆ ran relevant_history âˆ§              â”‚
â”‚          h.success = true} âˆ§                                           â”‚
â”‚     new_pattern.failed_syncs =                                         â”‚
â”‚       new_pattern.total_syncs - new_pattern.successful_syncs âˆ§         â”‚
â”‚     new_pattern.success_rate =                                         â”‚
â”‚       new_pattern.successful_syncs / new_pattern.total_syncs âˆ§         â”‚
â”‚     /* Predicted success based on pattern */                           â”‚
â”‚     new_pattern.predicted_success.strength =                           â”‚
â”‚       new_pattern.success_rate âˆ§                                       â”‚
â”‚     new_pattern.predicted_success.confidence =                         â”‚
â”‚       min(1.0, new_pattern.total_syncs / 100.0) âˆ§                      â”‚
â”‚     new_pattern âˆˆ ran pln_context'.sync_patterns                       â”‚
â”‚                                                                         â”‚
â”‚ pattern_found! = true                                                  â”‚
â”‚                                                                         â”‚
â”‚ /* Update learning statistics */                                       â”‚
â”‚ learning_context'.stats.patterns_learned =                             â”‚
â”‚   learning_context.stats.patterns_learned + 1                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/*=============================================================================
 * SECTION 6: DYNAMIC RECONFIGURATION OPERATIONS
 *===========================================================================*/

/**
 * TriggerAutoReconfiguration Operation
 *
 * Automatically triggers reconfiguration when performance drops.
 *
 * Pre-conditions:
 * - Auto-reconfiguration is enabled
 * - Performance is below threshold
 * - Minimum interval has passed
 *
 * Post-conditions:
 * - New configuration generated
 * - AtomSpace optimized (low-performing atoms removed)
 * - Reconfiguration counter incremented
 */
â”Œâ”€ TriggerAutoReconfiguration â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”SystemState                                                           â”‚
â”‚ current_time? : TIMESTAMP                                              â”‚
â”‚ output_path? : NAME                                                    â”‚
â”‚ reconfig_triggered! : ğ”¹                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ reconfig_context.auto_enabled                                          â”‚
â”‚ production_monitor.success_rate < reconfig_context.threshold           â”‚
â”‚ current_time? â‰¥                                                        â”‚
â”‚   reconfig_context.last_reconfig_time +                                â”‚
â”‚   reconfig_context.min_interval                                        â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ /* Remove low-performing atoms */                                      â”‚
â”‚ âˆ€ a : Atom | a âˆˆ ran atomspace.atom_table âˆ§                            â”‚
â”‚              a.atom_type = atom_module âˆ§                               â”‚
â”‚              a.tv.strength < 0.3 âˆ§                                     â”‚
â”‚              a.av.sti < 0 â‡’                                            â”‚
â”‚   a.handle âˆ‰ dom atomspace'.atom_table                                 â”‚
â”‚                                                                         â”‚
â”‚ /* Generate new configuration */                                       â”‚
â”‚ config_generated(agent_zero, atomspace', output_path?)                 â”‚
â”‚                                                                         â”‚
â”‚ /* Update reconfiguration context */                                   â”‚
â”‚ reconfig_context'.reconfig_count =                                     â”‚
â”‚   reconfig_context.reconfig_count + 1                                  â”‚
â”‚ reconfig_context'.last_reconfig_time = current_time?                   â”‚
â”‚ reconfig_context'.last_success_rate =                                  â”‚
â”‚   production_monitor.success_rate                                      â”‚
â”‚                                                                         â”‚
â”‚ reconfig_triggered! = true                                             â”‚
â”‚                                                                         â”‚
â”‚ /* Update system timestamp */                                          â”‚
â”‚ last_config_gen' = current_time?                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/**
 * GenerateConfiguration Operation
 *
 * Generates rsyncd.conf from current AtomSpace state.
 *
 * Pre-conditions:
 * - Agent Zero is operational
 * - AtomSpace contains at least one module
 *
 * Post-conditions:
 * - Configuration file written
 * - All modules represented with TV/AV metadata
 * - Swarm formations included
 * - Generation timestamp recorded
 */
â”Œâ”€ GenerateConfiguration â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ÎSystemState                                                           â”‚
â”‚ output_path? : NAME                                                    â”‚
â”‚ current_time? : TIMESTAMP                                              â”‚
â”‚ success! : ğ”¹                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ agent_zero.state âˆˆ {cog_state_idle, cog_state_active}                  â”‚
â”‚ âˆƒ a : Atom | a âˆˆ ran atomspace.atom_table âˆ§                            â”‚
â”‚              a.atom_type = atom_module                                 â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ /* Configuration file contains all modules */                          â”‚
â”‚ âˆ€ a : Atom | a âˆˆ ran atomspace.atom_table âˆ§                            â”‚
â”‚              a.atom_type = atom_module â‡’                               â”‚
â”‚   config_file_contains_module(output_path?, a)                         â”‚
â”‚                                                                         â”‚
â”‚ /* Each module entry includes cognitive metadata */                    â”‚
â”‚ âˆ€ a : ModuleAtom | a âˆˆ ran atomspace.atom_table â‡’                      â”‚
â”‚   config_includes_metadata(output_path?, a.handle,                     â”‚
â”‚                           a.tv, a.av)                                  â”‚
â”‚                                                                         â”‚
â”‚ /* Swarm formations included */                                        â”‚
â”‚ âˆ€ sf : SwarmFormation | sf âˆˆ ran swarm_formations âˆ§                    â”‚
â”‚                        sf.state = swarm_active â‡’                       â”‚
â”‚   config_includes_swarm(output_path?, sf)                              â”‚
â”‚                                                                         â”‚
â”‚ success! = true                                                        â”‚
â”‚ last_config_gen' = current_time?                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/*=============================================================================
 * SECTION 7: DISTRIBUTED ATOMSPACE OPERATIONS
 *===========================================================================*/

/**
 * SyncDistributedAtomSpace Operation
 *
 * Synchronizes AtomSpace with a remote node.
 *
 * Pre-conditions:
 * - Remote node exists and is connected
 * - Local AtomSpace has changes to propagate
 *
 * Post-conditions:
 * - Changed atoms sent to remote node
 * - Remote changes merged locally
 * - Conflicts resolved according to strategy
 * - Sync statistics updated
 */
â”Œâ”€ SyncDistributedAtomSpace â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Î”SystemState                                                           â”‚
â”‚ node_id? : HANDLE                                                      â”‚
â”‚ current_time? : TIMESTAMP                                              â”‚
â”‚ atoms_sent! : â„•                                                        â”‚
â”‚ atoms_received! : â„•                                                    â”‚
â”‚ conflicts! : â„•                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /* Pre-conditions */                                                   â”‚
â”‚ âˆƒ node : AtomSpaceNode | node âˆˆ ran distributed_as.nodes âˆ§             â”‚
â”‚   node.node_id = node_id? âˆ§                                            â”‚
â”‚   node.connected = true                                                â”‚
â”‚                                                                         â”‚
â”‚ /* Post-conditions */                                                  â”‚
â”‚ /* Atoms created/modified since last sync are sent */                  â”‚
â”‚ âˆƒ changed_atoms : â„™ Atom |                                             â”‚
â”‚   changed_atoms = {a : Atom | a âˆˆ ran atomspace.atom_table âˆ§           â”‚
â”‚     a.last_accessed > node.last_sync} âˆ§                                â”‚
â”‚   atoms_sent! = #changed_atoms                                         â”‚
â”‚                                                                         â”‚
â”‚ /* Receive atoms from remote */                                        â”‚
â”‚ âˆƒ received_atoms : â„™ Atom |                                            â”‚
â”‚   atoms_received! = #received_atoms âˆ§                                  â”‚
â”‚   /* Merge received atoms into local AtomSpace */                      â”‚
â”‚   âˆ€ remote_atom : Atom | remote_atom âˆˆ received_atoms â‡’                â”‚
â”‚     âˆƒ local_atom : Atom |                                              â”‚
â”‚       (remote_atom.handle âˆˆ dom atomspace.atom_table â‡’                 â”‚
â”‚         /* Conflict resolution */                                      â”‚
â”‚         resolve_conflict(distributed_as.conflict_resolution,           â”‚
â”‚                         atomspace.atom_table(remote_atom.handle),      â”‚
â”‚                         remote_atom, local_atom)) âˆ§                    â”‚
â”‚       local_atom âˆˆ ran atomspace'.atom_table                           â”‚
â”‚                                                                         â”‚
â”‚ /* Count conflicts */                                                  â”‚
â”‚ conflicts! = #{a : Atom | a âˆˆ received_atoms âˆ§                         â”‚
â”‚                           a.handle âˆˆ dom atomspace.atom_table}         â”‚
â”‚                                                                         â”‚
â”‚ /* Update node sync state */                                           â”‚
â”‚ âˆƒ old_node, new_node : AtomSpaceNode |                                 â”‚
â”‚   old_node âˆˆ ran distributed_as.nodes âˆ§                                â”‚
â”‚   old_node.node_id = node_id? âˆ§                                        â”‚
â”‚   new_node.node_id = old_node.node_id âˆ§                                â”‚
â”‚   new_node.last_sync = current_time? âˆ§                                 â”‚
â”‚   new_node.atoms_synced = old_node.atoms_synced + atoms_sent! âˆ§        â”‚
â”‚   new_node âˆˆ ran distributed_as'.nodes                                 â”‚
â”‚                                                                         â”‚
â”‚ /* Update distributed statistics */                                    â”‚
â”‚ distributed_as'.atoms_sent =                                           â”‚
â”‚   distributed_as.atoms_sent + atoms_sent!                              â”‚
â”‚ distributed_as'.atoms_received =                                       â”‚
â”‚   distributed_as.atoms_received + atoms_received!                      â”‚
â”‚ distributed_as'.conflicts_resolved =                                   â”‚
â”‚   distributed_as.conflicts_resolved + conflicts!                       â”‚
â”‚ distributed_as'.last_incremental_sync = current_time?                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/*******************************************************************************
 * END OF OPERATIONS SPECIFICATION
 *
 * This specification defines all state-modifying operations in the RsyncOG
 * cognitive architecture. Each operation preserves the system invariants
 * defined in the System State specification.
 ******************************************************************************/
